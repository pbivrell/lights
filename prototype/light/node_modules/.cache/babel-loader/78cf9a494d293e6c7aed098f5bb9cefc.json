{"ast":null,"code":"import _classCallCheck from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Util } from './Util.js';\nimport { Animation } from './Animation.js';\nimport { Node } from './Node.js';\nimport { Konva } from './Global.js';\nvar blacklist = {\n  node: 1,\n  duration: 1,\n  easing: 1,\n  onFinish: 1,\n  yoyo: 1\n},\n    PAUSED = 1,\n    PLAYING = 2,\n    REVERSING = 3,\n    idCounter = 0,\n    colorAttrs = ['fill', 'stroke', 'shadowColor'];\n\nvar TweenEngine = /*#__PURE__*/function () {\n  function TweenEngine(prop, propFunc, func, begin, finish, duration, yoyo) {\n    _classCallCheck(this, TweenEngine);\n\n    this.prop = prop;\n    this.propFunc = propFunc;\n    this.begin = begin;\n    this._pos = begin;\n    this.duration = duration;\n    this._change = 0;\n    this.prevPos = 0;\n    this.yoyo = yoyo;\n    this._time = 0;\n    this._position = 0;\n    this._startTime = 0;\n    this._finish = 0;\n    this.func = func;\n    this._change = finish - this.begin;\n    this.pause();\n  }\n\n  _createClass(TweenEngine, [{\n    key: \"fire\",\n    value: function fire(str) {\n      var handler = this[str];\n\n      if (handler) {\n        handler();\n      }\n    }\n  }, {\n    key: \"setTime\",\n    value: function setTime(t) {\n      if (t > this.duration) {\n        if (this.yoyo) {\n          this._time = this.duration;\n          this.reverse();\n        } else {\n          this.finish();\n        }\n      } else if (t < 0) {\n        if (this.yoyo) {\n          this._time = 0;\n          this.play();\n        } else {\n          this.reset();\n        }\n      } else {\n        this._time = t;\n        this.update();\n      }\n    }\n  }, {\n    key: \"getTime\",\n    value: function getTime() {\n      return this._time;\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(p) {\n      this.prevPos = this._pos;\n      this.propFunc(p);\n      this._pos = p;\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition(t) {\n      if (t === undefined) {\n        t = this._time;\n      }\n\n      return this.func(t, this.begin, this._change, this.duration);\n    }\n  }, {\n    key: \"play\",\n    value: function play() {\n      this.state = PLAYING;\n      this._startTime = this.getTimer() - this._time;\n      this.onEnterFrame();\n      this.fire('onPlay');\n    }\n  }, {\n    key: \"reverse\",\n    value: function reverse() {\n      this.state = REVERSING;\n      this._time = this.duration - this._time;\n      this._startTime = this.getTimer() - this._time;\n      this.onEnterFrame();\n      this.fire('onReverse');\n    }\n  }, {\n    key: \"seek\",\n    value: function seek(t) {\n      this.pause();\n      this._time = t;\n      this.update();\n      this.fire('onSeek');\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.pause();\n      this._time = 0;\n      this.update();\n      this.fire('onReset');\n    }\n  }, {\n    key: \"finish\",\n    value: function finish() {\n      this.pause();\n      this._time = this.duration;\n      this.update();\n      this.fire('onFinish');\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      this.setPosition(this.getPosition(this._time));\n      this.fire('onUpdate');\n    }\n  }, {\n    key: \"onEnterFrame\",\n    value: function onEnterFrame() {\n      var t = this.getTimer() - this._startTime;\n\n      if (this.state === PLAYING) {\n        this.setTime(t);\n      } else if (this.state === REVERSING) {\n        this.setTime(this.duration - t);\n      }\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      this.state = PAUSED;\n      this.fire('onPause');\n    }\n  }, {\n    key: \"getTimer\",\n    value: function getTimer() {\n      return new Date().getTime();\n    }\n  }]);\n\n  return TweenEngine;\n}();\n\nexport var Tween = /*#__PURE__*/function () {\n  function Tween(config) {\n    _classCallCheck(this, Tween);\n\n    var that = this,\n        node = config.node,\n        nodeId = node._id,\n        duration,\n        easing = config.easing || Easings.Linear,\n        yoyo = !!config.yoyo,\n        key;\n\n    if (typeof config.duration === 'undefined') {\n      duration = 0.3;\n    } else if (config.duration === 0) {\n      duration = 0.001;\n    } else {\n      duration = config.duration;\n    }\n\n    this.node = node;\n    this._id = idCounter++;\n    var layers = node.getLayer() || (node instanceof Konva['Stage'] ? node.getLayers() : null);\n\n    if (!layers) {\n      Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n    }\n\n    this.anim = new Animation(function () {\n      that.tween.onEnterFrame();\n    }, layers);\n    this.tween = new TweenEngine(key, function (i) {\n      that._tweenFunc(i);\n    }, easing, 0, 1, duration * 1000, yoyo);\n\n    this._addListeners();\n\n    if (!Tween.attrs[nodeId]) {\n      Tween.attrs[nodeId] = {};\n    }\n\n    if (!Tween.attrs[nodeId][this._id]) {\n      Tween.attrs[nodeId][this._id] = {};\n    }\n\n    if (!Tween.tweens[nodeId]) {\n      Tween.tweens[nodeId] = {};\n    }\n\n    for (key in config) {\n      if (blacklist[key] === undefined) {\n        this._addAttr(key, config[key]);\n      }\n    }\n\n    this.reset();\n    this.onFinish = config.onFinish;\n    this.onReset = config.onReset;\n    this.onUpdate = config.onUpdate;\n  }\n\n  _createClass(Tween, [{\n    key: \"_addAttr\",\n    value: function _addAttr(key, end) {\n      var node = this.node,\n          nodeId = node._id,\n          start,\n          diff,\n          tweenId,\n          n,\n          len,\n          trueEnd,\n          trueStart,\n          endRGBA;\n      tweenId = Tween.tweens[nodeId][key];\n\n      if (tweenId) {\n        delete Tween.attrs[nodeId][tweenId][key];\n      }\n\n      start = node.getAttr(key);\n\n      if (Util._isArray(end)) {\n        diff = [];\n        len = Math.max(end.length, start.length);\n\n        if (key === 'points' && end.length !== start.length) {\n          if (end.length > start.length) {\n            trueStart = start;\n            start = Util._prepareArrayForTween(start, end, node.closed());\n          } else {\n            trueEnd = end;\n            end = Util._prepareArrayForTween(end, start, node.closed());\n          }\n        }\n\n        if (key.indexOf('fill') === 0) {\n          for (n = 0; n < len; n++) {\n            if (n % 2 === 0) {\n              diff.push(end[n] - start[n]);\n            } else {\n              var startRGBA = Util.colorToRGBA(start[n]);\n              endRGBA = Util.colorToRGBA(end[n]);\n              start[n] = startRGBA;\n              diff.push({\n                r: endRGBA.r - startRGBA.r,\n                g: endRGBA.g - startRGBA.g,\n                b: endRGBA.b - startRGBA.b,\n                a: endRGBA.a - startRGBA.a\n              });\n            }\n          }\n        } else {\n          for (n = 0; n < len; n++) {\n            diff.push(end[n] - start[n]);\n          }\n        }\n      } else if (colorAttrs.indexOf(key) !== -1) {\n        start = Util.colorToRGBA(start);\n        endRGBA = Util.colorToRGBA(end);\n        diff = {\n          r: endRGBA.r - start.r,\n          g: endRGBA.g - start.g,\n          b: endRGBA.b - start.b,\n          a: endRGBA.a - start.a\n        };\n      } else {\n        diff = end - start;\n      }\n\n      Tween.attrs[nodeId][this._id][key] = {\n        start: start,\n        diff: diff,\n        end: end,\n        trueEnd: trueEnd,\n        trueStart: trueStart\n      };\n      Tween.tweens[nodeId][key] = this._id;\n    }\n  }, {\n    key: \"_tweenFunc\",\n    value: function _tweenFunc(i) {\n      var node = this.node,\n          attrs = Tween.attrs[node._id][this._id],\n          key,\n          attr,\n          start,\n          diff,\n          newVal,\n          n,\n          len,\n          end;\n\n      for (key in attrs) {\n        attr = attrs[key];\n        start = attr.start;\n        diff = attr.diff;\n        end = attr.end;\n\n        if (Util._isArray(start)) {\n          newVal = [];\n          len = Math.max(start.length, end.length);\n\n          if (key.indexOf('fill') === 0) {\n            for (n = 0; n < len; n++) {\n              if (n % 2 === 0) {\n                newVal.push((start[n] || 0) + diff[n] * i);\n              } else {\n                newVal.push('rgba(' + Math.round(start[n].r + diff[n].r * i) + ',' + Math.round(start[n].g + diff[n].g * i) + ',' + Math.round(start[n].b + diff[n].b * i) + ',' + (start[n].a + diff[n].a * i) + ')');\n              }\n            }\n          } else {\n            for (n = 0; n < len; n++) {\n              newVal.push((start[n] || 0) + diff[n] * i);\n            }\n          }\n        } else if (colorAttrs.indexOf(key) !== -1) {\n          newVal = 'rgba(' + Math.round(start.r + diff.r * i) + ',' + Math.round(start.g + diff.g * i) + ',' + Math.round(start.b + diff.b * i) + ',' + (start.a + diff.a * i) + ')';\n        } else {\n          newVal = start + diff * i;\n        }\n\n        node.setAttr(key, newVal);\n      }\n    }\n  }, {\n    key: \"_addListeners\",\n    value: function _addListeners() {\n      var _this = this;\n\n      this.tween.onPlay = function () {\n        _this.anim.start();\n      };\n\n      this.tween.onReverse = function () {\n        _this.anim.start();\n      };\n\n      this.tween.onPause = function () {\n        _this.anim.stop();\n      };\n\n      this.tween.onFinish = function () {\n        var node = _this.node;\n        var attrs = Tween.attrs[node._id][_this._id];\n\n        if (attrs.points && attrs.points.trueEnd) {\n          node.setAttr('points', attrs.points.trueEnd);\n        }\n\n        if (_this.onFinish) {\n          _this.onFinish.call(_this);\n        }\n      };\n\n      this.tween.onReset = function () {\n        var node = _this.node;\n        var attrs = Tween.attrs[node._id][_this._id];\n\n        if (attrs.points && attrs.points.trueStart) {\n          node.points(attrs.points.trueStart);\n        }\n\n        if (_this.onReset) {\n          _this.onReset();\n        }\n      };\n\n      this.tween.onUpdate = function () {\n        if (_this.onUpdate) {\n          _this.onUpdate.call(_this);\n        }\n      };\n    }\n  }, {\n    key: \"play\",\n    value: function play() {\n      this.tween.play();\n      return this;\n    }\n  }, {\n    key: \"reverse\",\n    value: function reverse() {\n      this.tween.reverse();\n      return this;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.tween.reset();\n      return this;\n    }\n  }, {\n    key: \"seek\",\n    value: function seek(t) {\n      this.tween.seek(t * 1000);\n      return this;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      this.tween.pause();\n      return this;\n    }\n  }, {\n    key: \"finish\",\n    value: function finish() {\n      this.tween.finish();\n      return this;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var nodeId = this.node._id,\n          thisId = this._id,\n          attrs = Tween.tweens[nodeId],\n          key;\n      this.pause();\n\n      for (key in attrs) {\n        delete Tween.tweens[nodeId][key];\n      }\n\n      delete Tween.attrs[nodeId][thisId];\n    }\n  }]);\n\n  return Tween;\n}();\nTween.attrs = {};\nTween.tweens = {};\n\nNode.prototype.to = function (params) {\n  var onFinish = params.onFinish;\n  params.node = this;\n\n  params.onFinish = function () {\n    this.destroy();\n\n    if (onFinish) {\n      onFinish();\n    }\n  };\n\n  var tween = new Tween(params);\n  tween.play();\n};\n\nexport var Easings = {\n  BackEaseIn: function BackEaseIn(t, b, c, d) {\n    var s = 1.70158;\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  },\n  BackEaseOut: function BackEaseOut(t, b, c, d) {\n    var s = 1.70158;\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  },\n  BackEaseInOut: function BackEaseInOut(t, b, c, d) {\n    var s = 1.70158;\n\n    if ((t /= d / 2) < 1) {\n      return c / 2 * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    }\n\n    return c / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n  },\n  ElasticEaseIn: function ElasticEaseIn(t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d) === 1) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n  },\n  ElasticEaseOut: function ElasticEaseOut(t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d) === 1) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;\n  },\n  ElasticEaseInOut: function ElasticEaseInOut(t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d / 2) === 2) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    if (t < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n    }\n\n    return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;\n  },\n  BounceEaseOut: function BounceEaseOut(t, b, c, d) {\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  },\n  BounceEaseIn: function BounceEaseIn(t, b, c, d) {\n    return c - Easings.BounceEaseOut(d - t, 0, c, d) + b;\n  },\n  BounceEaseInOut: function BounceEaseInOut(t, b, c, d) {\n    if (t < d / 2) {\n      return Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n    } else {\n      return Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n    }\n  },\n  EaseIn: function EaseIn(t, b, c, d) {\n    return c * (t /= d) * t + b;\n  },\n  EaseOut: function EaseOut(t, b, c, d) {\n    return -c * (t /= d) * (t - 2) + b;\n  },\n  EaseInOut: function EaseInOut(t, b, c, d) {\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t + b;\n    }\n\n    return -c / 2 * (--t * (t - 2) - 1) + b;\n  },\n  StrongEaseIn: function StrongEaseIn(t, b, c, d) {\n    return c * (t /= d) * t * t * t * t + b;\n  },\n  StrongEaseOut: function StrongEaseOut(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  },\n  StrongEaseInOut: function StrongEaseInOut(t, b, c, d) {\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t * t * t * t + b;\n    }\n\n    return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n  },\n  Linear: function Linear(t, b, c, d) {\n    return c * t / d + b;\n  }\n};","map":{"version":3,"sources":["/Users/pbivrell/light/light/node_modules/konva/lib/Tween.js"],"names":["Util","Animation","Node","Konva","blacklist","node","duration","easing","onFinish","yoyo","PAUSED","PLAYING","REVERSING","idCounter","colorAttrs","TweenEngine","prop","propFunc","func","begin","finish","_pos","_change","prevPos","_time","_position","_startTime","_finish","pause","str","handler","t","reverse","play","reset","update","p","undefined","state","getTimer","onEnterFrame","fire","setPosition","getPosition","setTime","Date","getTime","Tween","config","that","nodeId","_id","Easings","Linear","key","layers","getLayer","getLayers","error","anim","tween","i","_tweenFunc","_addListeners","attrs","tweens","_addAttr","onReset","onUpdate","end","start","diff","tweenId","n","len","trueEnd","trueStart","endRGBA","getAttr","_isArray","Math","max","length","_prepareArrayForTween","closed","indexOf","push","startRGBA","colorToRGBA","r","g","b","a","attr","newVal","round","setAttr","onPlay","onReverse","onPause","stop","points","call","seek","thisId","prototype","to","params","destroy","BackEaseIn","c","d","s","BackEaseOut","BackEaseInOut","ElasticEaseIn","abs","PI","asin","pow","sin","ElasticEaseOut","ElasticEaseInOut","BounceEaseOut","BounceEaseIn","BounceEaseInOut","EaseIn","EaseOut","EaseInOut","StrongEaseIn","StrongEaseOut","StrongEaseInOut"],"mappings":"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","sourcesContent":["import { Util } from './Util.js';\nimport { Animation } from './Animation.js';\nimport { Node } from './Node.js';\nimport { Konva } from './Global.js';\nvar blacklist = {\n    node: 1,\n    duration: 1,\n    easing: 1,\n    onFinish: 1,\n    yoyo: 1,\n}, PAUSED = 1, PLAYING = 2, REVERSING = 3, idCounter = 0, colorAttrs = ['fill', 'stroke', 'shadowColor'];\nclass TweenEngine {\n    constructor(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    }\n    fire(str) {\n        var handler = this[str];\n        if (handler) {\n            handler();\n        }\n    }\n    setTime(t) {\n        if (t > this.duration) {\n            if (this.yoyo) {\n                this._time = this.duration;\n                this.reverse();\n            }\n            else {\n                this.finish();\n            }\n        }\n        else if (t < 0) {\n            if (this.yoyo) {\n                this._time = 0;\n                this.play();\n            }\n            else {\n                this.reset();\n            }\n        }\n        else {\n            this._time = t;\n            this.update();\n        }\n    }\n    getTime() {\n        return this._time;\n    }\n    setPosition(p) {\n        this.prevPos = this._pos;\n        this.propFunc(p);\n        this._pos = p;\n    }\n    getPosition(t) {\n        if (t === undefined) {\n            t = this._time;\n        }\n        return this.func(t, this.begin, this._change, this.duration);\n    }\n    play() {\n        this.state = PLAYING;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onPlay');\n    }\n    reverse() {\n        this.state = REVERSING;\n        this._time = this.duration - this._time;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onReverse');\n    }\n    seek(t) {\n        this.pause();\n        this._time = t;\n        this.update();\n        this.fire('onSeek');\n    }\n    reset() {\n        this.pause();\n        this._time = 0;\n        this.update();\n        this.fire('onReset');\n    }\n    finish() {\n        this.pause();\n        this._time = this.duration;\n        this.update();\n        this.fire('onFinish');\n    }\n    update() {\n        this.setPosition(this.getPosition(this._time));\n        this.fire('onUpdate');\n    }\n    onEnterFrame() {\n        var t = this.getTimer() - this._startTime;\n        if (this.state === PLAYING) {\n            this.setTime(t);\n        }\n        else if (this.state === REVERSING) {\n            this.setTime(this.duration - t);\n        }\n    }\n    pause() {\n        this.state = PAUSED;\n        this.fire('onPause');\n    }\n    getTimer() {\n        return new Date().getTime();\n    }\n}\nexport class Tween {\n    constructor(config) {\n        var that = this, node = config.node, nodeId = node._id, duration, easing = config.easing || Easings.Linear, yoyo = !!config.yoyo, key;\n        if (typeof config.duration === 'undefined') {\n            duration = 0.3;\n        }\n        else if (config.duration === 0) {\n            duration = 0.001;\n        }\n        else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n        var layers = node.getLayer() ||\n            (node instanceof Konva['Stage'] ? node.getLayers() : null);\n        if (!layers) {\n            Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n        }\n        this.anim = new Animation(function () {\n            that.tween.onEnterFrame();\n        }, layers);\n        this.tween = new TweenEngine(key, function (i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n        this._addListeners();\n        if (!Tween.attrs[nodeId]) {\n            Tween.attrs[nodeId] = {};\n        }\n        if (!Tween.attrs[nodeId][this._id]) {\n            Tween.attrs[nodeId][this._id] = {};\n        }\n        if (!Tween.tweens[nodeId]) {\n            Tween.tweens[nodeId] = {};\n        }\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n        this.reset();\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n        this.onUpdate = config.onUpdate;\n    }\n    _addAttr(key, end) {\n        var node = this.node, nodeId = node._id, start, diff, tweenId, n, len, trueEnd, trueStart, endRGBA;\n        tweenId = Tween.tweens[nodeId][key];\n        if (tweenId) {\n            delete Tween.attrs[nodeId][tweenId][key];\n        }\n        start = node.getAttr(key);\n        if (Util._isArray(end)) {\n            diff = [];\n            len = Math.max(end.length, start.length);\n            if (key === 'points' && end.length !== start.length) {\n                if (end.length > start.length) {\n                    trueStart = start;\n                    start = Util._prepareArrayForTween(start, end, node.closed());\n                }\n                else {\n                    trueEnd = end;\n                    end = Util._prepareArrayForTween(end, start, node.closed());\n                }\n            }\n            if (key.indexOf('fill') === 0) {\n                for (n = 0; n < len; n++) {\n                    if (n % 2 === 0) {\n                        diff.push(end[n] - start[n]);\n                    }\n                    else {\n                        var startRGBA = Util.colorToRGBA(start[n]);\n                        endRGBA = Util.colorToRGBA(end[n]);\n                        start[n] = startRGBA;\n                        diff.push({\n                            r: endRGBA.r - startRGBA.r,\n                            g: endRGBA.g - startRGBA.g,\n                            b: endRGBA.b - startRGBA.b,\n                            a: endRGBA.a - startRGBA.a,\n                        });\n                    }\n                }\n            }\n            else {\n                for (n = 0; n < len; n++) {\n                    diff.push(end[n] - start[n]);\n                }\n            }\n        }\n        else if (colorAttrs.indexOf(key) !== -1) {\n            start = Util.colorToRGBA(start);\n            endRGBA = Util.colorToRGBA(end);\n            diff = {\n                r: endRGBA.r - start.r,\n                g: endRGBA.g - start.g,\n                b: endRGBA.b - start.b,\n                a: endRGBA.a - start.a,\n            };\n        }\n        else {\n            diff = end - start;\n        }\n        Tween.attrs[nodeId][this._id][key] = {\n            start: start,\n            diff: diff,\n            end: end,\n            trueEnd: trueEnd,\n            trueStart: trueStart,\n        };\n        Tween.tweens[nodeId][key] = this._id;\n    }\n    _tweenFunc(i) {\n        var node = this.node, attrs = Tween.attrs[node._id][this._id], key, attr, start, diff, newVal, n, len, end;\n        for (key in attrs) {\n            attr = attrs[key];\n            start = attr.start;\n            diff = attr.diff;\n            end = attr.end;\n            if (Util._isArray(start)) {\n                newVal = [];\n                len = Math.max(start.length, end.length);\n                if (key.indexOf('fill') === 0) {\n                    for (n = 0; n < len; n++) {\n                        if (n % 2 === 0) {\n                            newVal.push((start[n] || 0) + diff[n] * i);\n                        }\n                        else {\n                            newVal.push('rgba(' +\n                                Math.round(start[n].r + diff[n].r * i) +\n                                ',' +\n                                Math.round(start[n].g + diff[n].g * i) +\n                                ',' +\n                                Math.round(start[n].b + diff[n].b * i) +\n                                ',' +\n                                (start[n].a + diff[n].a * i) +\n                                ')');\n                        }\n                    }\n                }\n                else {\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + diff[n] * i);\n                    }\n                }\n            }\n            else if (colorAttrs.indexOf(key) !== -1) {\n                newVal =\n                    'rgba(' +\n                        Math.round(start.r + diff.r * i) +\n                        ',' +\n                        Math.round(start.g + diff.g * i) +\n                        ',' +\n                        Math.round(start.b + diff.b * i) +\n                        ',' +\n                        (start.a + diff.a * i) +\n                        ')';\n            }\n            else {\n                newVal = start + diff * i;\n            }\n            node.setAttr(key, newVal);\n        }\n    }\n    _addListeners() {\n        this.tween.onPlay = () => {\n            this.anim.start();\n        };\n        this.tween.onReverse = () => {\n            this.anim.start();\n        };\n        this.tween.onPause = () => {\n            this.anim.stop();\n        };\n        this.tween.onFinish = () => {\n            var node = this.node;\n            var attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueEnd) {\n                node.setAttr('points', attrs.points.trueEnd);\n            }\n            if (this.onFinish) {\n                this.onFinish.call(this);\n            }\n        };\n        this.tween.onReset = () => {\n            var node = this.node;\n            var attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueStart) {\n                node.points(attrs.points.trueStart);\n            }\n            if (this.onReset) {\n                this.onReset();\n            }\n        };\n        this.tween.onUpdate = () => {\n            if (this.onUpdate) {\n                this.onUpdate.call(this);\n            }\n        };\n    }\n    play() {\n        this.tween.play();\n        return this;\n    }\n    reverse() {\n        this.tween.reverse();\n        return this;\n    }\n    reset() {\n        this.tween.reset();\n        return this;\n    }\n    seek(t) {\n        this.tween.seek(t * 1000);\n        return this;\n    }\n    pause() {\n        this.tween.pause();\n        return this;\n    }\n    finish() {\n        this.tween.finish();\n        return this;\n    }\n    destroy() {\n        var nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId], key;\n        this.pause();\n        for (key in attrs) {\n            delete Tween.tweens[nodeId][key];\n        }\n        delete Tween.attrs[nodeId][thisId];\n    }\n}\nTween.attrs = {};\nTween.tweens = {};\nNode.prototype.to = function (params) {\n    var onFinish = params.onFinish;\n    params.node = this;\n    params.onFinish = function () {\n        this.destroy();\n        if (onFinish) {\n            onFinish();\n        }\n    };\n    var tween = new Tween(params);\n    tween.play();\n};\nexport const Easings = {\n    BackEaseIn(t, b, c, d) {\n        var s = 1.70158;\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    BackEaseOut(t, b, c, d) {\n        var s = 1.70158;\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    BackEaseInOut(t, b, c, d) {\n        var s = 1.70158;\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n        }\n        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    },\n    ElasticEaseIn(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (-(a *\n            Math.pow(2, 10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);\n    },\n    ElasticEaseOut(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n            c +\n            b);\n    },\n    ElasticEaseInOut(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return (-0.5 *\n                (a *\n                    Math.pow(2, 10 * (t -= 1)) *\n                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +\n                b);\n        }\n        return (a *\n            Math.pow(2, -10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            c +\n            b);\n    },\n    BounceEaseOut(t, b, c, d) {\n        if ((t /= d) < 1 / 2.75) {\n            return c * (7.5625 * t * t) + b;\n        }\n        else if (t < 2 / 2.75) {\n            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        }\n        else if (t < 2.5 / 2.75) {\n            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        }\n        else {\n            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    },\n    BounceEaseIn(t, b, c, d) {\n        return c - Easings.BounceEaseOut(d - t, 0, c, d) + b;\n    },\n    BounceEaseInOut(t, b, c, d) {\n        if (t < d / 2) {\n            return Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n        }\n        else {\n            return Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n    },\n    EaseIn(t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n    EaseOut(t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n    EaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t + b;\n        }\n        return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n    StrongEaseIn(t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n    StrongEaseOut(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    StrongEaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t * t * t * t + b;\n        }\n        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n    Linear(t, b, c, d) {\n        return (c * t) / d + b;\n    },\n};\n"]},"metadata":{},"sourceType":"module"}