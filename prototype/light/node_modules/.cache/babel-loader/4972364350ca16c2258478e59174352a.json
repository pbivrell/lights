{"ast":null,"code":"import _slicedToArray from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function LightDetect(_ref){var name=_ref.name,all=_ref.all,lights=_ref.lights;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),clicked=_useState2[0],setClicked=_useState2[1];function onToggle(e){lights.forEach(function(v){axios.get(\"http://\".concat(all[v].ip,\"/toggle\"),{timeout:1000}).catch(function(resp){console.log(\"failed to toggle\");});});// After 1/2 a second check if the lights are on\nsetTimeout(function(){setClicked(!clicked);},500);}useEffect(function(){if(lights.length===1){axios.get(\"http://\".concat(all[lights[0]].ip,\"/status\"),{timeout:1000}).then(function(resp){console.log(resp.data.status);if(resp.data.status){setStatus(\"active\");}else{setStatus(\"inactive\");}}).catch(function(){setStatus(\"offline\");});}},[clicked]);var _useState3=useState(lights.length===1?\"loading\":\"\"),_useState4=_slicedToArray(_useState3,2),Status=_useState4[0],setStatus=_useState4[1];return/*#__PURE__*/_jsxs(\"div\",{style:Status===\"offline\"?{color:\"grey\"}:{},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onClick:function onClick(e){return onToggle(e);},defaultChecked:Status===\"active\",style:{float:\"right\",width:\"100px\"}}),/*#__PURE__*/_jsx(\"span\",{children:\"Name: \"}),/*#__PURE__*/_jsx(\"span\",{children:name}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:\"Devices(s): \"}),/*#__PURE__*/_jsx(\"span\",{children:lights.length===1?all[lights[0]].ip:lights.map(function(x){return all[x].name;}).join(\",\")})]},name);}","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/components/LightListItem.js"],"names":["React","useState","useEffect","axios","LightDetect","name","all","lights","clicked","setClicked","onToggle","e","forEach","v","get","ip","timeout","catch","resp","console","log","setTimeout","length","then","data","status","setStatus","Status","color","float","width","map","x","join"],"mappings":"kJAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAEA,cAAe,SAASC,CAAAA,WAAT,MAA0C,IAApBC,CAAAA,IAAoB,MAApBA,IAAoB,CAAdC,GAAc,MAAdA,GAAc,CAATC,MAAS,MAATA,MAAS,CAExD,cAA8BN,QAAQ,CAAC,KAAD,CAAtC,wCAAOO,OAAP,eAAgBC,UAAhB,eAEA,QAASC,CAAAA,QAAT,CAAkBC,CAAlB,CAAqB,CACpBJ,MAAM,CAACK,OAAP,CAAe,SAACC,CAAD,CAAO,CACrBV,KAAK,CAACW,GAAN,kBAAoBR,GAAG,CAACO,CAAD,CAAH,CAAOE,EAA3B,YAAwC,CAACC,OAAO,CAAE,IAAV,CAAxC,EAAyDC,KAAzD,CAA+D,SAACC,IAAD,CAAU,CACxEC,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACA,CAFD,EAGA,CAJD,EAMA;AACAC,UAAU,CAAC,UAAM,CAChBZ,UAAU,CAAC,CAACD,OAAF,CAAV,CACA,CAFS,CAEP,GAFO,CAAV,CAGA,CAGDN,SAAS,CAAC,UAAM,CACf,GAAIK,MAAM,CAACe,MAAP,GAAkB,CAAtB,CAAyB,CACxBnB,KAAK,CAACW,GAAN,kBAAoBR,GAAG,CAACC,MAAM,CAAC,CAAD,CAAP,CAAH,CAAeQ,EAAnC,YAAgD,CAACC,OAAO,CAAE,IAAV,CAAhD,EACCO,IADD,CACM,SAACL,IAAD,CAAU,CACfC,OAAO,CAACC,GAAR,CAAYF,IAAI,CAACM,IAAL,CAAUC,MAAtB,EACA,GAAIP,IAAI,CAACM,IAAL,CAAUC,MAAd,CAAsB,CACrBC,SAAS,CAAC,QAAD,CAAT,CACA,CAFD,IAEM,CACLA,SAAS,CAAC,UAAD,CAAT,CACA,CACD,CARD,EAQGT,KARH,CAQS,UAAM,CACdS,SAAS,CAAC,SAAD,CAAT,CACA,CAVD,EAWA,CACD,CAdQ,CAcN,CAAClB,OAAD,CAdM,CAAT,CAiBA,eAA4BP,QAAQ,CAACM,MAAM,CAACe,MAAP,GAAkB,CAAlB,CAAsB,SAAtB,CAAkC,EAAnC,CAApC,yCAAOK,MAAP,eAAeD,SAAf,eAEA,mBACI,aAAgB,KAAK,CAAGC,MAAM,GAAK,SAAX,CAAuB,CAACC,KAAK,CAAE,MAAR,CAAvB,CAAyC,EAAjE,wBACH,cACU,IAAI,CAAC,UADf,CAEC,OAAO,CAAE,iBAACjB,CAAD,QAAOD,CAAAA,QAAQ,CAACC,CAAD,CAAf,EAFV,CAGC,cAAc,CAAEgB,MAAM,GAAK,QAH5B,CAIC,KAAK,CAAE,CAACE,KAAK,CAAE,OAAR,CAAiBC,KAAK,CAAE,OAAxB,CAJR,EADG,cAOH,gCAPG,cAOgB,sBAAOzB,IAAP,EAPhB,cAOmC,aAPnC,cAQH,sCARG,cAQsB,sBAAQE,MAAM,CAACe,MAAP,GAAkB,CAAlB,CAAsBhB,GAAG,CAACC,MAAM,CAAC,CAAD,CAAP,CAAH,CAAeQ,EAArC,CAA0CR,MAAM,CAACwB,GAAP,CAAW,SAACC,CAAD,QAAO1B,CAAAA,GAAG,CAAC0B,CAAD,CAAH,CAAO3B,IAAd,EAAX,EAAgC4B,IAAhC,CAAqC,GAArC,CAAlD,EARtB,GAAU5B,IAAV,CADJ,CAYA","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nexport default function LightDetect({name, all, lights}) {\n\n\tconst [clicked, setClicked] = useState(false);\n\t\n\tfunction onToggle(e) {\n\t\tlights.forEach((v) => {\n\t\t\taxios.get(`http://${all[v].ip}/toggle`, {timeout: 1000}).catch((resp) => {\n\t\t\t\tconsole.log(\"failed to toggle\");\n\t\t\t});\n\t\t});\n\n\t\t// After 1/2 a second check if the lights are on\n\t\tsetTimeout(() => {\n\t\t\tsetClicked(!clicked);\n\t\t}, 500);\n\t}\n\n\n\tuseEffect(() => {\n\t\tif (lights.length === 1) {\n\t\t\taxios.get(`http://${all[lights[0]].ip}/status`, {timeout: 1000})\n\t\t\t.then((resp) => {\n\t\t\t\tconsole.log(resp.data.status);\n\t\t\t\tif (resp.data.status) {\n\t\t\t\t\tsetStatus(\"active\");\n\t\t\t\t}else {\n\t\t\t\t\tsetStatus(\"inactive\");\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tsetStatus(\"offline\");\n\t\t\t});\n\t\t}\n\t}, [clicked])\n\n\n\tconst [Status, setStatus] = useState(lights.length === 1 ? \"loading\" : \"\");\n\n\treturn (\n    \t<div key={name} style={ Status === \"offline\" ? {color: \"grey\"} : {}}>\n\t\t<input\n          \t\ttype='checkbox'\n\t\t\tonClick={(e) => onToggle(e)}\n\t\t\tdefaultChecked={Status === \"active\"}\n\t\t\tstyle={{float: \"right\", width: \"100px\"}}\n        \t/>\n\t\t<span>Name: </span><span>{name}</span><br/>\n\t\t<span>Devices(s): </span><span>{ lights.length === 1 ? all[lights[0]].ip : lights.map((x) => all[x].name ).join(\",\") }</span>\n    \t</div>\n  \t);\n}\n"]},"metadata":{},"sourceType":"module"}