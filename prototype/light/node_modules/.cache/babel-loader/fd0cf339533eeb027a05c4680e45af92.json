{"ast":null,"code":"import _classCallCheck from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Factory } from '../Factory.js';\nimport { Line } from './Line.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nimport { Path } from './Path.js';\nexport var Arrow = /*#__PURE__*/function (_Line) {\n  _inherits(Arrow, _Line);\n\n  var _super = _createSuper(Arrow);\n\n  function Arrow() {\n    _classCallCheck(this, Arrow);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Arrow, [{\n    key: \"_sceneFunc\",\n    value: function _sceneFunc(ctx) {\n      _get(_getPrototypeOf(Arrow.prototype), \"_sceneFunc\", this).call(this, ctx);\n\n      var PI2 = Math.PI * 2;\n      var points = this.points();\n      var tp = points;\n      var fromTension = this.tension() !== 0 && points.length > 4;\n\n      if (fromTension) {\n        tp = this.getTensionPoints();\n      }\n\n      var length = this.pointerLength();\n      var n = points.length;\n      var dx, dy;\n\n      if (fromTension) {\n        var lp = [tp[tp.length - 4], tp[tp.length - 3], tp[tp.length - 2], tp[tp.length - 1], points[n - 2], points[n - 1]];\n        var lastLength = Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);\n        var previous = Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);\n        dx = points[n - 2] - previous.x;\n        dy = points[n - 1] - previous.y;\n      } else {\n        dx = points[n - 2] - points[n - 4];\n        dy = points[n - 1] - points[n - 3];\n      }\n\n      var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n      var width = this.pointerWidth();\n\n      if (this.pointerAtEnding()) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.translate(points[n - 2], points[n - 1]);\n        ctx.rotate(radians);\n        ctx.moveTo(0, 0);\n        ctx.lineTo(-length, width / 2);\n        ctx.lineTo(-length, -width / 2);\n        ctx.closePath();\n        ctx.restore();\n\n        this.__fillStroke(ctx);\n      }\n\n      if (this.pointerAtBeginning()) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.translate(points[0], points[1]);\n\n        if (fromTension) {\n          dx = (tp[0] + tp[2]) / 2 - points[0];\n          dy = (tp[1] + tp[3]) / 2 - points[1];\n        } else {\n          dx = points[2] - points[0];\n          dy = points[3] - points[1];\n        }\n\n        ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n        ctx.moveTo(0, 0);\n        ctx.lineTo(-length, width / 2);\n        ctx.lineTo(-length, -width / 2);\n        ctx.closePath();\n        ctx.restore();\n\n        this.__fillStroke(ctx);\n      }\n    }\n  }, {\n    key: \"__fillStroke\",\n    value: function __fillStroke(ctx) {\n      var isDashEnabled = this.dashEnabled();\n\n      if (isDashEnabled) {\n        this.attrs.dashEnabled = false;\n        ctx.setLineDash([]);\n      }\n\n      ctx.fillStrokeShape(this);\n\n      if (isDashEnabled) {\n        this.attrs.dashEnabled = true;\n      }\n    }\n  }, {\n    key: \"getSelfRect\",\n    value: function getSelfRect() {\n      var lineRect = _get(_getPrototypeOf(Arrow.prototype), \"getSelfRect\", this).call(this);\n\n      var offset = this.pointerWidth() / 2;\n      return {\n        x: lineRect.x - offset,\n        y: lineRect.y - offset,\n        width: lineRect.width + offset * 2,\n        height: lineRect.height + offset * 2\n      };\n    }\n  }]);\n\n  return Arrow;\n}(Line);\nArrow.prototype.className = 'Arrow';\n\n_registerNode(Arrow);\n\nFactory.addGetterSetter(Arrow, 'pointerLength', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerWidth', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerAtBeginning', false);\nFactory.addGetterSetter(Arrow, 'pointerAtEnding', true);","map":{"version":3,"sources":["/Users/pbivrell/light/light/node_modules/konva/lib/shapes/Arrow.js"],"names":["Factory","Line","getNumberValidator","_registerNode","Path","Arrow","ctx","PI2","Math","PI","points","tp","fromTension","tension","length","getTensionPoints","pointerLength","n","dx","dy","lp","lastLength","calcLength","previous","getPointOnQuadraticBezier","min","x","y","radians","atan2","width","pointerWidth","pointerAtEnding","save","beginPath","translate","rotate","moveTo","lineTo","closePath","restore","__fillStroke","pointerAtBeginning","isDashEnabled","dashEnabled","attrs","setLineDash","fillStrokeShape","lineRect","offset","height","prototype","className","addGetterSetter"],"mappings":"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","sourcesContent":["import { Factory } from '../Factory.js';\nimport { Line } from './Line.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nimport { Path } from './Path.js';\nexport class Arrow extends Line {\n    _sceneFunc(ctx) {\n        super._sceneFunc(ctx);\n        var PI2 = Math.PI * 2;\n        var points = this.points();\n        var tp = points;\n        var fromTension = this.tension() !== 0 && points.length > 4;\n        if (fromTension) {\n            tp = this.getTensionPoints();\n        }\n        var length = this.pointerLength();\n        var n = points.length;\n        var dx, dy;\n        if (fromTension) {\n            const lp = [\n                tp[tp.length - 4],\n                tp[tp.length - 3],\n                tp[tp.length - 2],\n                tp[tp.length - 1],\n                points[n - 2],\n                points[n - 1],\n            ];\n            const lastLength = Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);\n            const previous = Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);\n            dx = points[n - 2] - previous.x;\n            dy = points[n - 1] - previous.y;\n        }\n        else {\n            dx = points[n - 2] - points[n - 4];\n            dy = points[n - 1] - points[n - 3];\n        }\n        var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n        var width = this.pointerWidth();\n        if (this.pointerAtEnding()) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[n - 2], points[n - 1]);\n            ctx.rotate(radians);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n            this.__fillStroke(ctx);\n        }\n        if (this.pointerAtBeginning()) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[0], points[1]);\n            if (fromTension) {\n                dx = (tp[0] + tp[2]) / 2 - points[0];\n                dy = (tp[1] + tp[3]) / 2 - points[1];\n            }\n            else {\n                dx = points[2] - points[0];\n                dy = points[3] - points[1];\n            }\n            ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n            this.__fillStroke(ctx);\n        }\n    }\n    __fillStroke(ctx) {\n        var isDashEnabled = this.dashEnabled();\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = false;\n            ctx.setLineDash([]);\n        }\n        ctx.fillStrokeShape(this);\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = true;\n        }\n    }\n    getSelfRect() {\n        const lineRect = super.getSelfRect();\n        const offset = this.pointerWidth() / 2;\n        return {\n            x: lineRect.x - offset,\n            y: lineRect.y - offset,\n            width: lineRect.width + offset * 2,\n            height: lineRect.height + offset * 2,\n        };\n    }\n}\nArrow.prototype.className = 'Arrow';\n_registerNode(Arrow);\nFactory.addGetterSetter(Arrow, 'pointerLength', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerWidth', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerAtBeginning', false);\nFactory.addGetterSetter(Arrow, 'pointerAtEnding', true);\n"]},"metadata":{},"sourceType":"module"}