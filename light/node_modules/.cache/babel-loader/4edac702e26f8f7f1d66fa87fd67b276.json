{"ast":null,"code":"var _jsxFileName = \"/Users/pbivrell/light/light/src/components/Styler.js\",\n    _s = $RefreshSig$();\n\nimport '../App.css';\nimport React, { useState, useEffect } from \"react\";\nimport { Stage, Layer } from 'react-konva';\nimport Bulb from \"../components/Bulb.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Styler() {\n  _s();\n\n  function processSequence(seq) {\n    console.log(seq);\n    var bytes = new Uint8Array(seq);\n    console.log(bytes);\n    let nextColors = [];\n    let delay = 0;\n\n    for (let i = 0; i < bytes.length; i += 8) {\n      if (bytes[i] === 0x3 && i === 0) {\n        let count = bytes[i + 2] << 8 | bytes[i + 1];\n        console.log(\"Count\", count);\n\n        for (let j = 0; j < count; j++) {\n          nextColors.push({\n            color: `rgb(0,0,0)`\n          });\n        }\n      } else if (bytes[i] === 0x1) {\n        let r = bytes[i + 1];\n        let g = bytes[i + 2];\n        let b = bytes[i + 3];\n        let index = bytes[i + 5] << 8 | bytes[i + 4];\n        console.log(\"color\", r, g, b, index);\n        nextColors[index] = {\n          color: `rgb(${r},${g},${b})`\n        };\n      } else if (bytes[i] === 0x2) {\n        delay += bytes[i + 4] << 24 | bytes[i + 3] << 16 | bytes[i + 2] << 8 | bytes[i + 1];\n        console.log(\"delay\", delay);\n        setTimeout(lights => {\n          console.log(\"Changed lights\");\n          setLights(lights);\n        }, delay, [...nextColors]);\n      }\n    }\n  }\n\n  const [lights, setLights] = useState([{\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }, {\n    color: `rgb(50,50,50)`\n  }]);\n  const rows = Math.floor((window.innerWidth - 200) / 170);\n  const radius = 50;\n  const xOffset = 120;\n  const yOffset = 120;\n  return /*#__PURE__*/_jsxDEV(Stage, {\n    width: window.innerWidth,\n    height: window.innerHeight,\n    children: /*#__PURE__*/_jsxDEV(Layer, {\n      children: lights.map(function (elem, idx) {\n        console.log(elem, idx);\n        return /*#__PURE__*/_jsxDEV(Bulb, {\n          x: xOffset + xOffset * (idx % rows),\n          y: yOffset + yOffset * Math.floor(idx / rows),\n          color: elem.color,\n          radius: radius\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 14\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 10\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Styler, \"n2Qo62jDwcuJQekJDAitcWKCuH0=\");\n\n_c = Styler;\nexport default Styler;\n\nvar _c;\n\n$RefreshReg$(_c, \"Styler\");","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/components/Styler.js"],"names":["React","useState","useEffect","Stage","Layer","Bulb","Styler","processSequence","seq","console","log","bytes","Uint8Array","nextColors","delay","i","length","count","j","push","color","r","g","b","index","setTimeout","lights","setLights","rows","Math","floor","window","innerWidth","radius","xOffset","yOffset","innerHeight","map","elem","idx"],"mappings":"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","sourcesContent":["import '../App.css';\nimport React, { useState, useEffect } from \"react\";\nimport { Stage, Layer } from 'react-konva';\nimport Bulb from \"../components/Bulb.js\"\n\nfunction Styler() {\n\n\tfunction processSequence(seq) {\n\t\t\n\t\tconsole.log(seq);\n\n\t\tvar bytes = new Uint8Array(seq);\n\n\t\tconsole.log(bytes);\n\n\t\tlet nextColors = [];\n\t\t\n\t\tlet delay = 0;\n\t\t\t\n\t\tfor (let i=0; i<bytes.length; i+=8) {\n\t\t\tif (bytes[i] === 0x3 && i === 0) {\n\t\t\t\tlet count = (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"Count\", count);\n\t\t\t\tfor (let j = 0; j < count; j++) {\n\t\t\t\t\tnextColors.push({color: `rgb(0,0,0)`})\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if (bytes[i] === 0x1) {\n\t\t\t\tlet r = bytes[i+1];\n\t\t\t\tlet g = bytes[i+2];\n\t\t\t\tlet b =  bytes[i+3];\n\t\t\t\tlet index = (bytes[i+5] << 8) | bytes[i+4];\n\t\t\t\tconsole.log(\"color\", r,g,b, index);\n\t\t\t\tnextColors[index] = ({color: `rgb(${r},${g},${b})`})\n\t\t\t}else if (bytes[i] === 0x2) {\n\t\t\t\tdelay += (bytes[i+4] << 24) | (bytes[i+3] << 16) | (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"delay\", delay);\n\t\t\t\tsetTimeout((lights) => {\n\t\t\t\t\tconsole.log(\"Changed lights\");\n\t\t\t\t\tsetLights(lights);\n\t\t\t\t}, delay,[...nextColors] )\n\t\t\t}\n\t\t}\n        }\n\n\tconst [lights, setLights] = useState([{color: `rgb(50,50,50)`},{color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`} ]);\n\tconst rows = Math.floor((window.innerWidth - 200) / 170);\n\tconst radius = 50;\n\tconst xOffset = 120;\n\tconst yOffset = 120;\n\n\treturn (\n\t\t<Stage width={window.innerWidth} height={window.innerHeight}>\n      \t\t\t<Layer>\n\t\t\t\t{\n\t\t\t\t\tlights.map( function(elem, idx) {\n\t\t\t\t\t\tconsole.log(elem, idx);\n\t\t\t\t\t\treturn <Bulb x={xOffset + (xOffset * (idx % rows))} y={yOffset + (yOffset * Math.floor(idx / rows))} color={elem.color} radius={radius}/>\n\t\t\t\t\t})\n\t\t\t\t}\n      \t\t\t</Layer>\n    \t\t</Stage>\n  \t);\n}\n\n\nexport default Styler;\n"]},"metadata":{},"sourceType":"module"}