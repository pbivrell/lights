{"ast":null,"code":"import _objectSpread from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./Picker2.css';import React,{useState,useEffect}from\"react\";import{HuePicker,AlphaPicker}from'react-color';import bulb from'../res/Bulb_crop.png';import offbulb from'../res/OffBulb_crop.png';import disconnectedbulb from'../res/DisconnectedBulb_crop.png';import axios from\"axios\";import{displayError}from\"../lib/hooks\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Picker2(_ref){var name=_ref.name,hub=_ref.hub;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),light=_useState2[0],setLight=_useState2[1];useEffect(function(){getLight();},[]);var _useState3=useState({hsl:{a:1},rgb:{a:1},hex:\"\"}),_useState4=_slicedToArray(_useState3,2),color=_useState4[0],setColor=_useState4[1];function getLight(){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/user/hub/\").concat(hub,\"/light/\").concat(name),{withCredentials:true}).then(function(resp){setLight(resp.data);var pattern=resp.data.PatternID.split(\"~\")[1].split(\".\")[0].split(\"-\");console.log(pattern);setColor({rgb:{r:pattern[0],g:pattern[1],b:pattern[2],a:pattern[3]/100},hex:\"rgba(\".concat(pattern[0],\",\").concat(pattern[1],\",\").concat(pattern[2],\",\").concat(pattern[3]/100),hsl:{a:pattern[3]/100}});}).catch(function(e){displayError(e);});}/*function pushLight(pushColor) {\n\t\tlet data = generateBinary(pushColor, light.Count);\n                let blob = new Blob([data], {type: \"application/octet-stream\"});\n                let bodyFormData = new FormData();\n                bodyFormData.append(\"file\", blob, `${pushColor.r}-${pushColor.g}-${pushColor.b}-${pushColor.a}.bin`);\n\n                axios({\n                \tmethod: \"post\",\n                \turl: `http://${light.IP}/upload`,\n                \tdata: bodyFormData,\n                \theaders: { \"Content-Type\": \"multipart/form-data\" },\n                })\n                .then(function (response) {\n                \tconsole.log(response);\n                })\n                .catch(function (response) {\n                \tdisplayError(response)\n                });\n\t}*/function pushLight(pushColor){axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/user/hub/\").concat(hub,\"/light/\").concat(name,\"?p=~\").concat(pushColor.r,\"-\").concat(pushColor.g,\"-\").concat(pushColor.b,\"-\").concat(Math.floor(pushColor.a*100),\".bin\"),null,{withCredentials:true}).then(function(resp){console.log(\"toggled\");}).catch(function(e){displayError(e);});}function pushToggle(s){var lightStatus=\"on\";if(!s){lightStatus=\"off\";}axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/user/hub/\").concat(hub,\"/light/\").concat(name,\"?s=\").concat(lightStatus),null,{withCredentials:true}).then(function(resp){console.log(\"toggled\");}).catch(function(e){displayError(e);});}function toggleBulb(){var map=_objectSpread({},light);map.Status=!map.Status;setLight(map);pushToggle(map.Status);}function onColorChange(hue,c){console.log(c);var hsl=c.hsl;var rgb=c.rgb;if(!hue){hsl.a=color.hsl.a;rgb.a=color.rgb.a;}setColor({hsl:hsl,rgb:c.rgb,hex:\"rgba(\".concat(c.rgb.r,\",\").concat(c.rgb.g,\",\").concat(c.rgb.b,\",\").concat(hsl.a)});pushLight(c.rgb);}function generateBinary(color,pixels){var data=new Uint8Array((2+pixels)*8);var bytes=getInt64Bytes(pixels);var count=bytes[bytes.length-2]<<8|bytes[bytes.length-1];data[0]=0x3;data[1]=bytes[bytes.length-1];data[2]=bytes[bytes.length-2];for(var i=0;i<pixels;i++){var _bytes=getInt64Bytes(i);data[(i+1)*8]=0x1;data[(i+1)*8+1]=parseInt(color.r*color.a);data[(i+1)*8+2]=parseInt(color.g*color.a);data[(i+1)*8+3]=parseInt(color.b*color.a);data[(i+1)*8+4]=_bytes[_bytes.length-1];data[(i+1)*8+5]=_bytes[_bytes.length-2];}data[8+pixels*8]=0x2;data[8+pixels*8+1]=200;data[8+pixels*8+2]=0;data[8+pixels*8+3]=0;data[8+pixels*8+4]=0;console.log(data);return data;}function getInt64Bytes(x){var y=Math.floor(x/Math.pow(2,32));return[y,y<<8,y<<16,y<<24,x,x<<8,x<<16,x<<24].map(function(z){return z>>>24;});}function getToolTip(){console.log(light);if(!light){return\"\";}return\"ID: \".concat(light.ID,\"\\n\").concat(new Date(light.Updated).toLocaleDateString()+\" \"+new Date(light.Updated).toLocaleTimeString());}return/*#__PURE__*/_jsxs(\"div\",{className:\"Picker\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ButtonText\",\"data-tooltip\":getToolTip(),children:light.Alias===\"\"?light.Alias:light.Name}),/*#__PURE__*/_jsx(\"div\",{className:\"Button\",style:{background:color.hex},onClick:toggleBulb,children:/*#__PURE__*/_jsx(\"img\",{className:\"ButtonImage\",src:light.Status?bulb:offbulb})}),light.Status?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(HuePicker,{className:\"ButtonImage\",color:color.hsl,onChangeComplete:function onChangeComplete(c){return onColorChange(false,c);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(AlphaPicker,{className:\"ButtonImage\",color:color.hsl,onChangeComplete:function onChangeComplete(c){return onColorChange(true,c);}})]}):/*#__PURE__*/_jsx(_Fragment,{})]});}export default Picker2;","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/components/Picker2.js"],"names":["React","useState","useEffect","HuePicker","AlphaPicker","bulb","offbulb","disconnectedbulb","axios","displayError","Picker2","name","hub","light","setLight","getLight","hsl","a","rgb","hex","color","setColor","get","process","env","REACT_APP_API_URL","withCredentials","then","resp","data","pattern","PatternID","split","console","log","r","g","b","catch","e","pushLight","pushColor","post","Math","floor","pushToggle","s","lightStatus","toggleBulb","map","Status","onColorChange","hue","c","generateBinary","pixels","Uint8Array","bytes","getInt64Bytes","count","length","i","parseInt","x","y","z","getToolTip","ID","Date","Updated","toLocaleDateString","toLocaleTimeString","Alias","Name","background"],"mappings":"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","sourcesContent":["import './Picker2.css';\nimport React, { useState, useEffect } from \"react\";\nimport { HuePicker, AlphaPicker } from 'react-color'\nimport bulb from '../res/Bulb_crop.png';\nimport offbulb from '../res/OffBulb_crop.png';\nimport disconnectedbulb from '../res/DisconnectedBulb_crop.png';\nimport axios from \"axios\";\nimport {displayError} from \"../lib/hooks\";\n\nfunction Picker2({name, hub}) {\n\n\t\n\tconst [light, setLight] = useState({});\n\n\tuseEffect(() => {\n\t\tgetLight();\n\t}, [])\n\n\n  \tconst [color, setColor] = useState({ hsl: {a: 1}, rgb: {a: 1}, hex: \"\"});\n\t\n\tfunction getLight() {\n\t\t\n\t\taxios.get(`${process.env.REACT_APP_API_URL}/user/hub/${hub}/light/${name}`, {\n\t\t\twithCredentials: true,\n\t\t}).then((resp) => {\n\t\t\tsetLight(resp.data);\n\t\t\tlet pattern = resp.data.PatternID.split(\"~\")[1].split(\".\")[0].split(\"-\");\n\t\t\tconsole.log(pattern);\n\t\t\tsetColor({\n\t\t\t\trgb: {r: pattern[0], g: pattern[1], b: pattern[2], a: pattern[3]/100},\n\t\t\t\thex: `rgba(${pattern[0]},${pattern[1]},${pattern[2]},${pattern[3]/100}`,\n\t\t\t\thsl: {a: pattern[3]/100},\n\n\t\t\t});\n\t\t}).catch((e) => {\n\t\t\tdisplayError(e);\n\t\t});\n\t}\n\n\t/*function pushLight(pushColor) {\n\t\tlet data = generateBinary(pushColor, light.Count);\n                let blob = new Blob([data], {type: \"application/octet-stream\"});\n                let bodyFormData = new FormData();\n                bodyFormData.append(\"file\", blob, `${pushColor.r}-${pushColor.g}-${pushColor.b}-${pushColor.a}.bin`);\n\n                axios({\n                \tmethod: \"post\",\n                \turl: `http://${light.IP}/upload`,\n                \tdata: bodyFormData,\n                \theaders: { \"Content-Type\": \"multipart/form-data\" },\n                })\n                .then(function (response) {\n                \tconsole.log(response);\n                })\n                .catch(function (response) {\n                \tdisplayError(response)\n                });\n\t}*/\n\n\tfunction pushLight(pushColor) {\n\t\taxios.post(`${process.env.REACT_APP_API_URL}/user/hub/${hub}/light/${name}?p=~${pushColor.r}-${pushColor.g}-${pushColor.b}-${Math.floor(pushColor.a * 100)}.bin`,null, {\n\t\t\twithCredentials: true,\n\t\t})\n\t\t.then((resp) => {\n\t\t\tconsole.log(\"toggled\");\n\t\t})\n\t\t.catch((e) => {\n        \t\tdisplayError(e);\n\t\t});\n\t}\n\n\tfunction pushToggle(s) {\n\t\tlet lightStatus = \"on\";\n\t\tif (!s) {\n\t\t\tlightStatus = \"off\"\n\t\t}\n\n\t\taxios.post(`${process.env.REACT_APP_API_URL}/user/hub/${hub}/light/${name}?s=${lightStatus}`, null, {\n\t\t\twithCredentials: true,\n\t\t})\n\t\t.then((resp) => {\n\t\t\tconsole.log(\"toggled\");\n\t\t})\n\t\t.catch((e) => {\n        \t\tdisplayError(e);\n\t\t});\n\t}\n\n\tfunction toggleBulb() {\n\t\tconst map = {...light};\n                map.Status = !map.Status;\n                setLight(map);\n\t\tpushToggle(map.Status);\n\t}\n\n\tfunction onColorChange(hue, c) {\n\n\t\tconsole.log(c);\n\n\t\tlet hsl = c.hsl;\n\t\tlet rgb = c.rgb;\n\n\t\tif(!hue) {\n\t\t\thsl.a = color.hsl.a;\n\t\t\trgb.a = color.rgb.a;\n\t\t}\n\t\tsetColor({hsl: hsl, rgb: c.rgb, hex: `rgba(${c.rgb.r},${c.rgb.g},${c.rgb.b},${hsl.a}`});\n\t\t\n\t\tpushLight(c.rgb);\n\t}\n\t\n\t\n\tfunction generateBinary(color, pixels) {\n\t\t\n\t\tlet data = new Uint8Array((2 + pixels) * 8);\n\t\tlet bytes = getInt64Bytes(pixels);\n\n\t\tlet count = (bytes[bytes.length-2] << 8) | bytes[bytes.length-1];\n\t\t\n\t\tdata[0] = 0x3;\n\t\tdata[1] = bytes[bytes.length-1];\n\t\tdata[2] = bytes[bytes.length-2];\n\n\t\tfor (let i = 0; i < pixels; i++) {\n\t\t\tlet bytes = getInt64Bytes(i);\n\t\t \tdata[(i + 1) * 8] = 0x1;\n\t\t\tdata[(i + 1) * 8 + 1] = parseInt(color.r * color.a) ;\n\t\t\tdata[(i + 1) * 8 + 2] = parseInt(color.g * color.a);\n\t\t\tdata[(i + 1) * 8 + 3] = parseInt(color.b * color.a);\n\t\t\tdata[(i + 1) * 8 + 4] = bytes[bytes.length-1];\n\t\t\tdata[(i + 1) * 8 + 5] = bytes[bytes.length-2];\n\t\t}\n\n\t\tdata[8 + (pixels * 8)] = 0x2;\n\t\tdata[8 + (pixels * 8) + 1] = 200;\n\t\tdata[8 + (pixels * 8) + 2] = 0;\n\t\tdata[8 + (pixels * 8) + 3] = 0;\n\t\tdata[8 + (pixels * 8) + 4] = 0;\n\n\n\t\tconsole.log(data);\n\t\treturn data;\n\n\t}\n\n\tfunction getInt64Bytes(x) {\n  \t\tlet y= Math.floor(x/2**32);\n  \t\treturn [y,(y<<8),(y<<16),(y<<24), x,(x<<8),(x<<16),(x<<24)].map(z=> z>>>24)\n\t}\n\n\tfunction getToolTip() {\n\t\tconsole.log(light);\n\t\tif (!light) {\n\t\t\treturn \"\"\n\t\t}\n\t\treturn `ID: ${light.ID}\n${new Date(light.Updated).toLocaleDateString() +\" \" +  new Date(light.Updated).toLocaleTimeString()}`\n\t}\n\n\treturn (\n\t<div className=\"Picker\">\n\n\t\t<div className=\"ButtonText\" data-tooltip={getToolTip()}>{light.Alias === \"\" ? light.Alias : light.Name }</div>\n\t\t<div className=\"Button\" style={{background: color.hex}} onClick={toggleBulb}>\n\t\t\t<img className=\"ButtonImage\" src={light.Status ? bulb : offbulb }></img>\n\t\t</div>\n\t\t{ light.Status ? \n\t\t\t<>\n\t\t\t\t<br/>\n\t\t\t\t<HuePicker className=\"ButtonImage\" color={color.hsl} onChangeComplete={(c) => onColorChange(false, c)}/>\n\t\t\t\t<br/>\n                \t\t<AlphaPicker className=\"ButtonImage\" color={color.hsl} onChangeComplete={(c) => onColorChange(true, c)}/>\n\t\t\t</>\n\t\t: \n\t\t\t<></>\n\t\t}\n\t</div>\n  \t);\n}\n\n\nexport default Picker2;\n"]},"metadata":{},"sourceType":"module"}