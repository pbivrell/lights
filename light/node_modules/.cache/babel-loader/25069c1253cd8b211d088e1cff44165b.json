{"ast":null,"code":"import _slicedToArray from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'../App.css';import React,{useState,useEffect}from\"react\";import{Stage,Layer}from'react-konva';import Bulb from\"../components/Bulb.js\";import{jsx as _jsx}from\"react/jsx-runtime\";function Styler(){function processSequence(seq){console.log(seq);var bytes=new Uint8Array(seq);console.log(bytes);var nextColors=[];var delay=0;for(var i=0;i<bytes.length;i+=8){if(bytes[i]===0x3&&i===0){var count=bytes[i+2]<<8|bytes[i+1];console.log(\"Count\",count);for(var j=0;j<count;j++){nextColors.push({color:\"rgb(0,0,0)\"});}}else if(bytes[i]===0x1){var r=bytes[i+1];var g=bytes[i+2];var b=bytes[i+3];var index=bytes[i+5]<<8|bytes[i+4];console.log(\"color\",r,g,b,index);nextColors[index]={color:\"rgb(\".concat(r,\",\").concat(g,\",\").concat(b,\")\")};}else if(bytes[i]===0x2){delay+=bytes[i+4]<<24|bytes[i+3]<<16|bytes[i+2]<<8|bytes[i+1];console.log(\"delay\",delay);setTimeout(function(lights){console.log(\"Changed lights\");setLights(lights);},delay,[].concat(nextColors));}}}var _useState=useState([{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"},{color:\"rgb(50,50,50)\"}]),_useState2=_slicedToArray(_useState,2),lights=_useState2[0],setLights=_useState2[1];var rows=Math.floor((window.innerWidth-200)/170);var radius=50;var xOffset=120;var yOffset=120;return/*#__PURE__*/_jsx(Stage,{width:window.innerWidth,height:200,children:/*#__PURE__*/_jsx(Layer,{children:lights.map(function(elem,idx){console.log(elem,idx);return/*#__PURE__*/_jsx(Bulb,{x:xOffset+xOffset*(idx%rows),y:yOffset+yOffset*Math.floor(idx/rows),color:elem.color,radius:radius});})})});}export default Styler;","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/components/Styler.js"],"names":["React","useState","useEffect","Stage","Layer","Bulb","Styler","processSequence","seq","console","log","bytes","Uint8Array","nextColors","delay","i","length","count","j","push","color","r","g","b","index","setTimeout","lights","setLights","rows","Math","floor","window","innerWidth","radius","xOffset","yOffset","map","elem","idx"],"mappings":"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","sourcesContent":["import '../App.css';\nimport React, { useState, useEffect } from \"react\";\nimport { Stage, Layer } from 'react-konva';\nimport Bulb from \"../components/Bulb.js\"\n\nfunction Styler() {\n\n\tfunction processSequence(seq) {\n\t\t\n\t\tconsole.log(seq);\n\n\t\tvar bytes = new Uint8Array(seq);\n\n\t\tconsole.log(bytes);\n\n\t\tlet nextColors = [];\n\t\t\n\t\tlet delay = 0;\n\t\t\t\n\t\tfor (let i=0; i<bytes.length; i+=8) {\n\t\t\tif (bytes[i] === 0x3 && i === 0) {\n\t\t\t\tlet count = (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"Count\", count);\n\t\t\t\tfor (let j = 0; j < count; j++) {\n\t\t\t\t\tnextColors.push({color: `rgb(0,0,0)`})\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if (bytes[i] === 0x1) {\n\t\t\t\tlet r = bytes[i+1];\n\t\t\t\tlet g = bytes[i+2];\n\t\t\t\tlet b =  bytes[i+3];\n\t\t\t\tlet index = (bytes[i+5] << 8) | bytes[i+4];\n\t\t\t\tconsole.log(\"color\", r,g,b, index);\n\t\t\t\tnextColors[index] = ({color: `rgb(${r},${g},${b})`})\n\t\t\t}else if (bytes[i] === 0x2) {\n\t\t\t\tdelay += (bytes[i+4] << 24) | (bytes[i+3] << 16) | (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"delay\", delay);\n\t\t\t\tsetTimeout((lights) => {\n\t\t\t\t\tconsole.log(\"Changed lights\");\n\t\t\t\t\tsetLights(lights);\n\t\t\t\t}, delay,[...nextColors] )\n\t\t\t}\n\t\t}\n        }\n\n\tconst [lights, setLights] = useState([{color: `rgb(50,50,50)`},{color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`}, {color: `rgb(50,50,50)`} ]);\n\tconst rows = Math.floor((window.innerWidth - 200) / 170);\n\tconst radius = 50;\n\tconst xOffset = 120;\n\tconst yOffset = 120;\n\n\treturn (\n\t\t<Stage width={window.innerWidth} height={200}>\n      \t\t\t<Layer>\n\t\t\t\t{\n\t\t\t\t\tlights.map( function(elem, idx) {\n\t\t\t\t\t\tconsole.log(elem, idx);\n\t\t\t\t\t\treturn <Bulb x={xOffset + (xOffset * (idx % rows))} y={yOffset + (yOffset * Math.floor(idx / rows))} color={elem.color} radius={radius}/>\n\t\t\t\t\t})\n\t\t\t\t}\n      \t\t\t</Layer>\n    \t\t</Stage>\n  \t);\n}\n\n\nexport default Styler;\n"]},"metadata":{},"sourceType":"module"}