{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import'../App.css';import'../index.css';import'bootstrap/dist/css/bootstrap.css';import React,{useState,useEffect}from\"react\";import LightListItem from\"../components/LightListItem\";import Offcanvas from\"react-bootstrap/Offcanvas\";import Button from\"react-bootstrap/Button\";import ListGroup from\"react-bootstrap/ListGroup\";import axios from\"axios\";import FileBrowser from'react-keyed-file-browser';import'../../node_modules/react-keyed-file-browser/dist/react-keyed-file-browser.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Other(){function getData(){return _getData.apply(this,arguments);}function _getData(){_getData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:case\"end\":return _context.stop();}}},_callee);}));return _getData.apply(this,arguments);}var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];function getData(){console.log(\"getting data\");axios.get(\"http://homeserver/lights/config.json\").then(function(resp){var blob=resp.data;setData(blob);});}var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),files=_useState4[0],setFiles=_useState4[1];function getFiles(){axios.get(\"http://homeserver/lights/patterns/files.json\").then(function(resp){var blob=resp.data;setFiles(blob);});}var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedFile=_useState6[0],setSelectedFile=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),selectedLight=_useState8[0],setSelectedLight=_useState8[1];function clickFile(file){var bodyFormData=new FormData();if(!selectedLight){return;}axios.get(\"http://homeserver/lights/patterns/\".concat(file.key),{responseType:'arraybuffer'}).then(function(resp){var bytes=new Uint8Array(resp.data);var blob=new Blob([resp.data],{type:\"application/octet-stream\"});bodyFormData.append(\"file\",blob,file.key);console.log(selectedLight);selectedLight.lights.forEach(function(light){axios({method:\"post\",url:\"http://\".concat(data.lights[light].ip,\"/upload\"),data:bodyFormData,headers:{\"Content-Type\":\"multipart/form-data\"}}).then(function(response){//handle success\nconsole.log(response);}).catch(function(response){//handle error\nconsole.log(response);});console.log(data.lights[light]);});});}function clickLight(light){setSelectedLight(light);console.log(light);}useEffect(function(){getData();getFiles();},[]);var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),show=_useState10[0],setShow=_useState10[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleShow,children:\"Launch\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Selected Light: \",/*#__PURE__*/_jsx(\"span\",{children:selectedLight?selectedLight.name:\"\"})]}),/*#__PURE__*/_jsxs(Offcanvas,{show:show,onHide:handleClose,scroll:true,backdrop:false,children:[/*#__PURE__*/_jsx(Offcanvas.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Offcanvas.Title,{children:\"Lights\"})}),/*#__PURE__*/_jsx(Offcanvas.Body,{children:/*#__PURE__*/_jsx(ListGroup,{children:data.groups?data.groups.map(function(v,i){return/*#__PURE__*/_jsx(ListGroup.Item,{action:true,onClick:function onClick(){return clickLight(v);},children:/*#__PURE__*/_jsx(LightListItem,{name:v.name,all:data.lights,lights:v.lights})},i);}):/*#__PURE__*/_jsx(_Fragment,{})})})]}),/*#__PURE__*/_jsx(FileBrowser,{files:files,onSelectFile:clickFile})]});}export default Other;","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/containers/other.js"],"names":["React","useState","useEffect","LightListItem","Offcanvas","Button","ListGroup","axios","FileBrowser","Other","getData","data","setData","console","log","get","then","resp","blob","files","setFiles","getFiles","selectedFile","setSelectedFile","selectedLight","setSelectedLight","clickFile","file","bodyFormData","FormData","key","responseType","bytes","Uint8Array","Blob","type","append","lights","forEach","light","method","url","ip","headers","response","catch","clickLight","show","setShow","handleClose","handleShow","name","groups","map","v","i"],"mappings":"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","sourcesContent":["import '../App.css';\nimport '../index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport React, { useState, useEffect } from \"react\";\nimport LightListItem from \"../components/LightListItem\";\nimport Offcanvas from \"react-bootstrap/Offcanvas\";\nimport Button from \"react-bootstrap/Button\";\nimport ListGroup from \"react-bootstrap/ListGroup\";\nimport axios from \"axios\";\nimport FileBrowser from 'react-keyed-file-browser'\nimport '../../node_modules/react-keyed-file-browser/dist/react-keyed-file-browser.css';\n\n\nfunction Other() {\n\n\tasync function getData() {\n\n\n\t\t/*return {\n\t\t\tlights: [\n\t\t\t\t{\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: \"lower tree\",\n\t\t\t\t\tip: \"192.168.86.146\",\n\t\t\t\t\tpixels: 100,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 1,\n\t\t\t\t\tname: \"upper tree\",\n\t\t\t\t\tip: \"192.168.86.145\",\n\t\t\t\t\tpixels: 100,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 2,\n\t\t\t\t\tname: \"test\",\n\t\t\t\t\tip: \"192.168.86.140\",\n\t\t\t\t\tpixels: 50,\n\t\t\t\t}\n\t\t\t],\n\t\t\tgroups: [\n\t\t\t\t{\n\t\t\t\t\tname: \"lower tree\",\n\t\t\t\t\tlights: [0],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"upper tree\",\n\t\t\t\t\tlights: [1],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"test\",\n\t\t\t\t\tlights: [2],\n\t\t\t\t},\t\n\t\t\t\t{\n\t\t\t\t\tname: \"tree\",\n\t\t\t\t\tlights: [ 0, 1 ],\n\t\t\t\t}\n\t\t\t]\n\t\t}*/\n\t}\n\n\tconst [data, setData] = useState({});\n\n\tfunction getData() {\n\t\tconsole.log(\"getting data\");\n\n\t\taxios.get(\"http://homeserver/lights/config.json\").then((resp) => {\n\t\t\tlet blob = resp.data;\n\t\t\tsetData(blob);\n\t\t});\n\t}\n\n\tconst [files, setFiles] = useState([]);\n\tfunction getFiles() {\n\t\taxios.get(\"http://homeserver/lights/patterns/files.json\").then((resp) => {\n\t\t\tlet blob = resp.data;\n\t\t\tsetFiles(blob);\n\t\t});\n\n\t}\n\n\tconst [selectedFile, setSelectedFile] = useState();\n\tconst [selectedLight, setSelectedLight] = useState();\n\n\tfunction clickFile(file) {\n\n\t\tvar bodyFormData = new FormData();\n\n\t\tif (!selectedLight) {\n\t\t\treturn;\n\t\t}\n\n\t\taxios.get(`http://homeserver/lights/patterns/${file.key}`,  { responseType: 'arraybuffer' }\n).then((resp) => {\n\n\t\t\tlet bytes = new Uint8Array(resp.data);\n\n\t\t\tlet blob = new Blob([resp.data], {type: \"application/octet-stream\"});\n\n\t\t\tbodyFormData.append(\"file\", blob, file.key);\n\n\t\t\tconsole.log(selectedLight);\n\t\t\tselectedLight.lights.forEach((light) => {\n\t\t\t\taxios({\n\t\t\t\t\tmethod: \"post\",\n\t\t\t\t\turl: `http://${data.lights[light].ip}/upload`,\n\t\t\t\t\tdata: bodyFormData,\n\t\t\t\t\theaders: { \"Content-Type\": \"multipart/form-data\" },\n\t\t\t\t})\n\t\t\t\t\t.then(function (response) {\n\t\t\t\t\t\t//handle success\n\t\t\t\t\t\tconsole.log(response);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function (response) {\n\t\t\t\t\t\t//handle error\n\t\t\t\t\t\tconsole.log(response);\n\t\t\t\t\t});\n\n\t\t\t\tconsole.log(data.lights[light]);\n\t\t\t});\n\t\t});\n\n\t}\n\n\tfunction clickLight(light) {\n\t\tsetSelectedLight(light);\n\t\tconsole.log(light);\n\t}\n\n\tuseEffect(() => {\n\t\tgetData()\n\t\tgetFiles()\n\t}, []);\n\n\n\tconst [show, setShow] = useState(false);\n\n\tconst handleClose = () => setShow(false);\n\tconst handleShow = () => setShow(true);\n\n\treturn (\n\t\t<>\n\t\t<Button variant=\"primary\" onClick={handleShow}>\n\t\tLaunch\n\t\t</Button>\n\n\t\t<h3>Selected Light: <span>{selectedLight? selectedLight.name : \"\" }</span></h3>\n\n\t\t<Offcanvas show={show} onHide={handleClose} scroll={true} backdrop={false}>\n\t\t<Offcanvas.Header closeButton>\n\t\t<Offcanvas.Title>Lights</Offcanvas.Title>\n\t\t</Offcanvas.Header>\n\t\t<Offcanvas.Body>\n\t\t<ListGroup>\n\t\t{\n\t\t\tdata.groups ? \n\t\t\t(data.groups.map((v, i) => {\n\t\t\t\treturn (\n\t\t\t\t\t<ListGroup.Item action key={i} onClick={ () => clickLight(v) } >\n\t\t\t\t\t<LightListItem name={v.name} all={data.lights} lights={v.lights}/>\n\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t);\n\t\t\t}))\n\t\t\t: <></>\n\t\t}\n\t\t</ListGroup>\n\t\t</Offcanvas.Body>\n\t\t</Offcanvas>\n\t\t<FileBrowser\n\t\tfiles={files} onSelectFile={clickFile}\n\t\t/>\n\n\t\t</>\n\t);\n}\n\n\nexport default Other;\n"]},"metadata":{},"sourceType":"module"}