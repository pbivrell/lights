{"ast":null,"code":"var _jsxFileName = \"/Users/pbivrell/light/light/src/containers/programming.js\",\n    _s = $RefreshSig$();\n\nimport '../App.css';\nimport React, { useState, useEffect } from \"react\";\nimport { Stage, Layer } from 'react-konva';\nimport Bulb from \"../components/Bulb.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Programming() {\n  _s();\n\n  const seq = \"00000011000010100000000000000000000000000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000000000010000000010000000000000000000000000000000000000000000000000000001000000001000000000000000000000010000000000000000000000000000000100000000100000000000000000000010000000000000000000000000000000010000000010000000000000000000001100000000000000000000000000000001000000001000000000000000000001000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000000000011000000010000000000000000000000000000000000000000000000000000001100000001000000000000000000000010000000000000000000000000000000110000000100000000000000000000010000000000000000000000000000000011000000010000000000000000000001100000000000000000000000000000001100000001000000000000000000001000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000\"; //const seq = \"000000101111010000000001000000000000000000000000000000000000000000000001000000001000000000000000000000000000000000000000000000000000000100000000100000000000000000000001000000000000000000000000000000010000000010000000000000000000001000000000000000000000000000000001000000001000000000000000000000110000000000000000000000000000000100000000100000000000000000000100000000000000000000000000000000101111010000000001000000000000000000000000000000000000000000000001100000001000000000000000000000000000000000000000000000000000000110000000100000000000000000000001000000000000000000000000000000011000000010000000000000000000001000000000000000000000000000000001100000001000000000000000000000110000000000000000000000000000000110000000100000000000000000000100000000000000000000000000\";\n\n  function handleFiles(e) {\n    var fr = new FileReader();\n\n    fr.onload = function () {\n      console.log(fr.result);\n    };\n\n    console.log(e.target.files);\n  }\n\n  function processSequence() {\n    var bytes = new Uint8Array(seq.length);\n\n    for (var i = 0; i < seq.length; i += 8) {\n      console.log(seq.slice(i, i + 8), parseInt(seq.slice(i, i + 8), 2));\n      bytes[Math.floor(i / 8)] = parseInt(seq.slice(i, i + 8), 2);\n    }\n\n    let nextColors = [];\n    let delay = 0;\n\n    for (let i = 0; i < bytes.length; i += 8) {\n      if (bytes[i] === 0x3 && i === 0) {\n        let count = bytes[i + 2] << 8 | bytes[i + 1];\n        console.log(\"Count\", count);\n\n        for (let j = 0; j < count; j++) {\n          nextColors.push({\n            color: `rgb(0,0,0)`\n          });\n        }\n      } else if (bytes[i] === 0x1) {\n        let r = bytes[i + 1];\n        let g = bytes[i + 2];\n        let b = bytes[i + 3];\n        let index = bytes[i + 5] << 8 | bytes[i + 4];\n        console.log(\"color\", r, g, b, index);\n        nextColors[index] = {\n          color: `rgb(${r},${g},${b})`\n        };\n      } else if (bytes[i] === 0x2) {\n        delay += bytes[i + 4] << 24 | bytes[i + 3] << 16 | bytes[i + 2] << 8 | bytes[i + 1];\n        console.log(\"delay\", delay);\n        setTimeout(lights => {\n          console.log(\"Changed lights\");\n          setLights(lights);\n        }, delay, [...nextColors]);\n      }\n    }\n  }\n\n  useEffect(() => {\n    processSequence();\n  }, []);\n  const [lights, setLights] = useState([]);\n  const rows = Math.floor((window.innerWidth - 200) / 170);\n  const radius = 50;\n  const xOffset = 120;\n  const yOffset = 120;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      name: \"file\",\n      onChange: handleFiles\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: /*#__PURE__*/_jsxDEV(Stage, {\n        width: window.innerWidth,\n        height: window.innerHeight - 100,\n        children: /*#__PURE__*/_jsxDEV(Layer, {\n          children: lights.map(function (elem, idx) {\n            console.log(elem, idx);\n            return /*#__PURE__*/_jsxDEV(Bulb, {\n              x: xOffset + xOffset * (idx % rows),\n              y: yOffset + yOffset * Math.floor(idx / rows),\n              color: elem.color,\n              radius: radius\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 4\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 3\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 2\n  }, this);\n}\n\n_s(Programming, \"5swNKp7TI0Y5yaMWaGsRVL6kSk8=\");\n\n_c = Programming;\nexport default Programming;\n\nvar _c;\n\n$RefreshReg$(_c, \"Programming\");","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/containers/programming.js"],"names":["React","useState","useEffect","Stage","Layer","Bulb","Programming","seq","handleFiles","e","fr","FileReader","onload","console","log","result","target","files","processSequence","bytes","Uint8Array","length","i","slice","parseInt","Math","floor","nextColors","delay","count","j","push","color","r","g","b","index","setTimeout","lights","setLights","rows","window","innerWidth","radius","xOffset","yOffset","innerHeight","map","elem","idx"],"mappings":"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","sourcesContent":["import '../App.css';\nimport React, { useState, useEffect } from \"react\";\nimport { Stage, Layer } from 'react-konva';\nimport Bulb from \"../components/Bulb.js\"\n\nfunction Programming () {\n\n\tconst seq = \"00000011000010100000000000000000000000000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000000000010000000010000000000000000000000000000000000000000000000000000001000000001000000000000000000000010000000000000000000000000000000100000000100000000000000000000010000000000000000000000000000000010000000010000000000000000000001100000000000000000000000000000001000000001000000000000000000001000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000000000011000000010000000000000000000000000000000000000000000000000000001100000001000000000000000000000010000000000000000000000000000000110000000100000000000000000000010000000000000000000000000000000011000000010000000000000000000001100000000000000000000000000000001100000001000000000000000000001000000000000000000000000000000001011101000000000110000000000000000000000000000000000000000\";\n\n\t//const seq = \"000000101111010000000001000000000000000000000000000000000000000000000001000000001000000000000000000000000000000000000000000000000000000100000000100000000000000000000001000000000000000000000000000000010000000010000000000000000000001000000000000000000000000000000001000000001000000000000000000000110000000000000000000000000000000100000000100000000000000000000100000000000000000000000000000000101111010000000001000000000000000000000000000000000000000000000001100000001000000000000000000000000000000000000000000000000000000110000000100000000000000000000001000000000000000000000000000000011000000010000000000000000000001000000000000000000000000000000001100000001000000000000000000000110000000000000000000000000000000110000000100000000000000000000100000000000000000000000000\";\n\n\tfunction handleFiles(e) {\n\t\tvar fr=new FileReader();\n\t\tfr.onload=function(){\n\t\t\tconsole.log(fr.result);\n\t\t}\n\n\t\t\n\t\tconsole.log(e.target.files);\n\t}\n\n\n\tfunction processSequence() {\n\t\tvar bytes = new Uint8Array(seq.length);\n\t\tfor (var i=0; i<seq.length; i+=8) {\n\t\t\tconsole.log(seq.slice(i, i + 8), parseInt(seq.slice(i, i + 8), 2));\n    \t\t\tbytes[Math.floor(i/8)] = parseInt(seq.slice(i,i+8), 2);\n\t\t}\n\n\t\tlet nextColors = [];\n\t\t\n\t\tlet delay = 0;\n\t\t\t\n\t\tfor (let i=0; i<bytes.length; i+=8) {\n\t\t\tif (bytes[i] === 0x3 && i === 0) {\n\t\t\t\tlet count = (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"Count\", count);\n\t\t\t\tfor (let j = 0; j < count; j++) {\n\t\t\t\t\tnextColors.push({color: `rgb(0,0,0)`})\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if (bytes[i] === 0x1) {\n\t\t\t\tlet r = bytes[i+1];\n\t\t\t\tlet g = bytes[i+2];\n\t\t\t\tlet b =  bytes[i+3];\n\t\t\t\tlet index = (bytes[i+5] << 8) | bytes[i+4];\n\t\t\t\tconsole.log(\"color\", r,g,b, index);\n\t\t\t\tnextColors[index] = ({color: `rgb(${r},${g},${b})`})\n\t\t\t}else if (bytes[i] === 0x2) {\n\t\t\t\tdelay += (bytes[i+4] << 24) | (bytes[i+3] << 16) | (bytes[i+2] << 8) | bytes[i+1];\n\t\t\t\tconsole.log(\"delay\", delay);\n\t\t\t\tsetTimeout((lights) => {\n\t\t\t\t\tconsole.log(\"Changed lights\");\n\t\t\t\t\tsetLights(lights);\n\t\t\t\t}, delay,[...nextColors] )\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\tprocessSequence();\t\n\t}, []);\n\n\tconst [lights, setLights] = useState([]);\n\tconst rows = Math.floor((window.innerWidth - 200) / 170);\n\tconst radius = 50;\n\tconst xOffset = 120;\n\tconst yOffset = 120;\n\n\treturn (\n\t<div className=\"App\">\n\t\t<input type=\"file\" name=\"file\" onChange={handleFiles} />\n\t\t<header className=\"App-header\">\n\t\t\t<Stage width={window.innerWidth} height={window.innerHeight - 100}>\n      \t\t\t\t<Layer>\n\t\t\t\t\t{\n\t\t\t\t\t\tlights.map( function(elem, idx) {\n\t\t\t\t\t\t\tconsole.log(elem, idx);\n\t\t\t\t\t\t\treturn <Bulb x={xOffset + (xOffset * (idx % rows))} y={yOffset + (yOffset * Math.floor(idx / rows))} color={elem.color} radius={radius}/>\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n      \t\t\t\t</Layer>\n    \t\t\t</Stage>\n\t\t</header>\n\t</div>\n  \t);\n}\n\n\nexport default Programming;\n"]},"metadata":{},"sourceType":"module"}