{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/pbivrell/light/light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Form from\"react-bootstrap/Form\";import Button from\"react-bootstrap/Button\";import Spinner from\"react-bootstrap/Spinner\";import axios from\"axios\";import Select from'react-select';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var baseURL=process.env.REACT_APP_URL;var timeout=10*1000;export default function LightDetect(_ref){var next=_ref.next;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),failed=_useState4[0],setFailed=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),networks=_useState6[0],setNetworks=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),ssid=_useState8[0],setSSID=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),password=_useState10[0],setPassword=_useState10[1];useEffect(function(){onLoad();},[]);function onLoad(){return _onLoad.apply(this,arguments);}function _onLoad(){_onLoad=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);axios.get(baseURL+\"/networks\",{timeout:timeout}).then(function(response){setNetworks(response.data);setLoading(false);}).catch(function(resp){setFailed(true);setLoading(false);});case 2:case\"end\":return _context.stop();}}},_callee);}));return _onLoad.apply(this,arguments);}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);axios.get(baseURL+\"/login?ssid=\".concat(ssid,\"&password=\").concat(password),{timeout:timeout}).then(function(response){next();}).catch(function(resp){setFailed(true);});setLoading(false);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _onSubmit.apply(this,arguments);}function onRetry(){setFailed(false);onLoad();}return/*#__PURE__*/_jsxs(\"div\",{children:[loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\" Searching for lights \"}),/*#__PURE__*/_jsx(Spinner,{animation:\"border\"}),/*#__PURE__*/_jsx(\"br\",{})]}):failed?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Failed to setup new lights\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return onRetry();},children:\"Retry\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Found new lights\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select Wifi you would like to connect them to\"}),/*#__PURE__*/_jsx(Select,{onChange:function onChange(selected){return setSSID(selected.value);},searchable:true,options:networks.map(function(d){return{\"value\":d,\"label\":d};})}),/*#__PURE__*/_jsx(\"label\",{children:\"Password: \"}),\" \",/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"name\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{onClick:onSubmit,children:\"Submit\"})]}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){next(-1);},children:\"Back\"})]});}","map":{"version":3,"sources":["/Users/pbivrell/light/light/src/components/LightDetect.js"],"names":["React","useState","useEffect","Form","Button","Spinner","axios","Select","baseURL","process","env","REACT_APP_URL","timeout","LightDetect","next","loading","setLoading","failed","setFailed","networks","setNetworks","ssid","setSSID","password","setPassword","onLoad","get","then","response","data","catch","resp","onSubmit","onRetry","selected","value","map","d","e","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport Spinner from \"react-bootstrap/Spinner\";\nimport axios from \"axios\";\nimport Select from 'react-select'\n\n\nconst baseURL = process.env.REACT_APP_URL;\nconst timeout = 10 * 1000;\n\nexport default function LightDetect({next}) {\n\tconst [loading, setLoading] = useState(true);\n\tconst [failed, setFailed] = useState(false);\n\tconst [networks, setNetworks] = useState([]);\n\tconst [ssid, setSSID] = useState(\"\");\n\tconst [password, setPassword] = useState(\"\");\n\n\n\tuseEffect(() => {\n  \t\tonLoad();\n\t}, []);\n\n\tasync function onLoad() {\n\t\tsetLoading(true);\n\t\taxios.get(baseURL + \"/networks\", { timeout: timeout}).then((response) => {\n\t\t\tsetNetworks(response.data);\n\t\t\tsetLoading(false);\n    \t\t}).catch((resp) => {\n\t\t\tsetFailed(true);\n\t\t\tsetLoading(false);\n\t\t});\n\t}\n\n\tasync function onSubmit() {\n\t\tsetLoading(true);\n\n\t\taxios.get(baseURL + `/login?ssid=${ssid}&password=${password}`, { timeout: timeout}).then((response) => {\n\t\t\tnext();\n    \t\t}).catch((resp) => {\n\t\t\tsetFailed(true);\n\t\t});\n\t\tsetLoading(false);\n\n\t}\n\n\tfunction onRetry() {\n\t\tsetFailed(false);\n\t\tonLoad();\n\t}\n\n\treturn (\n    \t<div>\n\t\t\t{ loading ? (\n\t\t\t\t<>\n\t\t\t\t\t<p> Searching for lights </p>\n\t\t\t\t\t<Spinner animation=\"border\">\n\t\t\t\t\t</Spinner>\n\t\t\t\t\t<br/>\n\t\t\t\t</>\n\t\t\t) : failed ? (\n\t\t\t\t<>\n\t\t\t\t\t<p>Failed to setup new lights</p>\n\t\t\t\t\t<Button onClick={() => onRetry()}>Retry</Button> \n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<p>Found new lights</p>\n\t\t\t\t\t<p>Select Wifi you would like to connect them to</p>\n\t\t\t\t\t<Select onChange={(selected) => setSSID(selected.value)} searchable options={networks.map(function(d){\n         \t\t\t\t\treturn ({ \"value\": d, \"label\": d })\n       \t\t\t\t\t})}/>\n\t\t\t\t\t<label>Password: </label> <input type=\"password\" name=\"name\" onChange={(e) => setPassword(e.target.value)}/><br/>\n\t\t\t\t\t<Button onClick={onSubmit}>Submit</Button>\t\n\t\t\t    \t</> \n\t\t\t) \n\t\t\t}\n\t\t\t<Button onClick={() => {next(-1)}}>Back</Button>\n    \t</div>\n  \t);\n}\n"]},"metadata":{},"sourceType":"module"}